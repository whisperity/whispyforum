<html>

<head>
<title>includes/users.class.php</title>
</head>

<body>

<h2 align="center">includes/users.class.php - user and session manager</h2>
<h3>Usage</h3>
<p>This class maintains the session and user managing</p>
<h3>Flags</h3>
<!--msimagelist--><table border="0" cellpadding="0" cellspacing="0" width="100%">
  <!--msimagelist--><tr>
    <!--msimagelist--><td valign="baseline" width="42">
    <img src="../style-data/flag.jpg" width="15" height="15" hspace="13" alt="listajel"></td>
    <td valign="top" width="100%">obligatory - this script is essential for the
    <a href="../general/framework.htm">framework</a><!--msimagelist--></td>
  </tr>
  <!--msimagelist--><tr>
    <!--msimagelist--><td valign="baseline" width="42">
    <img src="../style-data/flag.jpg" width="15" height="15" hspace="13" alt="listajel"></td>
    <td valign="top" width="100%">autoload - this script is automatically loaded by
    <a href="load.php.htm">loader</a><!--msimagelist--></td>
  </tr>
  <!--msimagelist--><tr>
    <!--msimagelist--><td valign="baseline" width="42">
    <img src="../style-data/flag.jpg" width="15" height="15" hspace="13" alt="listajel"></td>
    <td valign="top" width="100%">library - loading this script does not give direct output, it only 
  registers <a href="../general/classes.htm">classes</a>/<a href="../general/functions.htm">functions</a><!--msimagelist--></td>
  </tr>
  <!--msimagelist--></table>
<h3>Contents</h3>
<h4>
<img border="0" src="../style-data/function.gif" width="10" height="9" alt="function"> 
Functions</h4>
<ul>
  <li>
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public">
<a href="#pub_func_inicialize">Inicialize</a></li>
  <li>
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private">
<a href="#priv_func_createSession">__createSession</a></li>
  <li>
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private">
<a href="#priv_func_destroySession">__destroySession</a></li>
  <li>
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private">
<a href="#priv_func_checkUserData">__checkUserData</a></li>
  <li>
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public">
<a href="#pub_func_doUserForm">DoUserForm</a></li>
  <li>
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private">
<a href="#priv_func_doLoginForm">__doLoginForm</a></li>
  <li>
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private">
<a href="#priv_func_doUserForm">__doUserForm</a></li>
  <li>
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public">
<a href="#pub_func_login">Login</a></li>
  <li>
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public">
<a href="#pub_func_logout">Logout</a></li>
</ul>
<h3>Details</h3>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1" height="43">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="pub_func_inicialize"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public"> 
    Inicialize</h4>
    </td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">The function inicializes the session data.<br>
    Also loads the user's preferenced language file (thus loading the
    <a href="../general/globals.htm">$wf_lang global</a>)</td>
  </tr>
  <tr>
    <td width="5%" height="4">Calls</td>
    <td width="33%" height="4"><a href="#priv_func_createSession">
    __createSession</a><br>
    <a href="#priv_func_checkUserData">__checkUserData</a></td>
  </tr>
  <tr>
    <td width="5%" height="3">Gets</td>
    <td width="33%" height="3"><a href="../globals/session.htm">session</a></td>
  </tr>
  <tr>
    <td width="5%" height="3">Sets</td>
    <td width="33%" height="3"><a href="../globals/session.htm">session</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2" height="43">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="priv_func_createSession"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private"> 
    __createSession</h4>
    </td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">This private function generates a new session 
    with default data.</td>
  </tr>
  <tr>
    <td width="5%" height="10">Called by</td>
    <td width="33%" height="10"><a href="#pub_func_inicialize">Inicialize</a></td>
  </tr>
  <tr>
    <td width="5%" height="9">Sets</td>
    <td width="33%" height="9"><a href="../globals/session.htm">session</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber3" height="41">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="priv_func_destroySession"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private"> 
    __destroySession</h4>
    </td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">This private function clears the active session, 
    removes the session ID cookie from browser and destroys the session file.</td>
  </tr>
  <tr>
    <td width="5%" height="9">Called by</td>
    <td width="33%" height="9"><a href="#pub_func_logout">Logout</a></td>
  </tr>
  <tr>
    <td width="5%" height="8">Sets</td>
    <td width="33%" height="8"><a href="../globals/session.htm">session</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber4" height="43">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="priv_func_checkUserData"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private"> 
    __checkUserData</h4>
    </td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">The function compares the session's stored 
    values to the database.<p>If the user is logged in (based on session), 
    however, the database stores different IP address or session ID, we logout 
    the user from each sessions.</td>
  </tr>
  <tr>
    <td width="5%" height="10">Called by</td>
    <td width="33%" height="10"><a href="#pub_func_inicialize">Inicialize</a></td>
  </tr>
  <tr>
    <td width="5%" height="9">Calls</td>
    <td width="33%" height="9"><a href="#pub_func_logout">Logout</a></td>
  </tr>
  <tr>
    <td width="5%" height="3">Gets</td>
    <td width="33%" height="3"><a href="../globals/session.htm">session</a></td>
  </tr>
  <tr>
    <td width="5%" height="3">Sets</td>
    <td width="33%" height="3"><a href="../globals/session.htm">session</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber5" height="42">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="pub_func_doUserForm"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public"> 
    DoUserForm</h4>
    <p>Not to be confused with <a href="#priv_func_doUserForm">__doUserForm</a>!</td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">The function generates a login or a user control/logout 
    form based on login status.</td>
  </tr>
  <tr>
    <td width="5%" height="10">Calls</td>
    <td width="33%" height="10"><a href="#priv_func_doLoginForm">__doLoginForm</a><br>
    <a href="#priv_func_doUserForm">__doUserForm</a></td>
  </tr>
  <tr>
    <td width="5%" height="2">Gets</td>
    <td width="33%" height="2"><a href="../globals/session.htm">session</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber6" height="45">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="priv_func_doLoginForm"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private"> 
    __doLoginForm</h4>
    </td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">This private function creates a login form</td>
  </tr>
  <tr>
    <td width="5%" height="19">Called by</td>
    <td width="33%" height="19"><a href="#pub_func_doUserForm">DoUserForm</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber7" height="43">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="priv_func_doUserForm"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/private.gif" width="15" height="15" alt="private"> 
    __doUserForm</h4>
    <p>Not to be confused with <a href="#pub_func_doUserForm">DoUserForm</a>!</td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">This private function creates a user control/logout 
    form</td>
  </tr>
  <tr>
    <td width="5%" height="19">Called by</td>
    <td width="33%" height="19"><a href="#pub_func_doUserForm">DoUserForm</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber8" height="43">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="pub_func_login"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public"> 
    Login(username, password)</h4>
    </td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">This function logs in the user</td>
  </tr>
  <tr>
    <td width="5%" height="19">Parameters</td>
    <td width="33%" height="19">username -the login username entered into the 
    login form's fields<br>
    password - the password entered into the login form's fields</td>
    </tr>
  <tr>
    <td width="5%" height="19">Returns</td>
    <td width="33%" height="19">FALSE if the entered username/password was wrong<br>
    TRUE if the user logged in successfully</td>
  </tr>
  <tr>
    <td width="5%" height="3">Gets</td>
    <td width="33%" height="3"><a href="../globals/session.htm">session</a></td>
  </tr>
  <tr>
    <td width="5%" height="3">Sets</td>
    <td width="33%" height="3"><a href="../globals/session.htm">session</a></td>
  </tr>
  </table>

<p>&nbsp;</p>

<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber9" height="44">
  <tr>
    <td width="100%" colspan="2" height="1">
    <h4><a name="pub_func_logout"></a><img border="0" src="../style-data/function.gif" width="10" height="9" alt="function">
<img border="0" src="../style-data/public.gif" width="15" height="15" alt="public"> 
    Logout(username)</h4>
    </td>
  </tr>
  <tr>
    <td width="5%" height="19">Description</td>
    <td width="33%" height="19">This function logs out the user</td>
  </tr>
  <tr>
    <td width="5%" height="19">Parameters</td>
    <td width="33%" height="19">username - the username to be logged out</td>
  </tr>
  <tr>
    <td width="5%" height="11">Called by</td>
    <td width="33%" height="11"><a href="#priv_func_checkUserData">
    __checkUserData</a></td>
    </tr>
  <tr>
    <td width="5%" height="11">Calls</td>
    <td width="33%" height="11"><a href="#priv_func_destroySession">
    __destroySession</a></td>
    </tr>
  <tr>
    <td width="5%" height="11">Returns</td>
    <td width="33%" height="11">FALSE if there were any errors logging out the 
    user<br>
    TRUE if the user successfully logged out</td>
  </tr>
  <tr>
    <td width="5%" height="3">Gets</td>
    <td width="33%" height="3"><a href="../globals/session.htm">session</a></td>
  </tr>
  </table>

</body>

</html>